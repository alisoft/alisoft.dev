{"key":"content:fr:docs:5.configuration-glossary:28.configuration-servermiddleware.md","generatedAt":"2022-03-15T12:18:25.016Z","mtime":"2022-03-15T12:18:25.002Z","slug":"configuration-servermiddleware","title":"La propriété serverMiddleware","position":"999900050028","to":"/docs/configuration-glossary/configuration-servermiddleware","draft":false,"page":true,"language":"fr","navigation":{"title":"serverMiddleware"},"description":"Défini le middleware côté serveur.","menu":"serverMiddleware","category":"configuration-glossary","empty":false,"body":{"raw":"---\ntitle: La propriété serverMiddleware\nnavigation.title: serverMiddleware\ndescription: Défini le middleware côté serveur.\nmenu: serverMiddleware\ncategory: configuration-glossary\n---\n# La propriété serverMiddleware\n\nDéfini le middleware côté serveur.\n\n---\n\n- Type: `Array`\n  - Items: `String` ou `Object` ou `Function`\n\nNuxt crée en interne une instance [connect](https://github.com/senchalabs/connect) à laquelle vous pouvez ajouter votre propre middleware personnalisé. Cela nous permet d'enregistrer des routes supplémentaires (généralement des routes `/api`) **sans avoir besoin d'un serveur externe**.\n\nParce que Connect itself est un middleware, les middleware enregistrés fonctionneront avec `nuxt start` et aussi lorsqu'il est utilisé comme un middleware avec des usages programmatiques comme [express-template](https://github.com/nuxt-community/express-template). Les [Modules](/docs/directory-structure/modules) nuxt peuvent également fournir `serverMiddleware` en utilisant [this.addServerMiddleware()](/docs/internals-glossary/internals-module-container#addservermiddleware-middleware)\n\nEn plus, nous avons introduit une option `prefix` dont la valeur par défaut est `true`. Elle ajoutera la base du routeur aux middlewares de votre serveur.\n\n**Exemple:**\n\n- Chemin d'accès au middleware du serveur : `/server-middleware`\n- Base du routeur : `/admin`\n- Avec `prefix: true` (par défaut): `/admin/server-middleware`\n- Avec `prefix: false`: `/server-middleware`\n\n## serverMiddleware vs middleware!\n\nNe le confondez pas avec [routes middleware](/docs/directory-structure/middleware#router-middleware) qui sont appelés avant chaque route par Vue pour les rendu monopage ou SSR. Les Middleware listés dans la propriété `serverMiddleware` s'exécutent côté serveur **avant** `vue-server-renderer` et peuvent être utilisés pour des tâches spécifiques au serveur comme le traitement des requêtes API ou pour le chargement des ressources.\n\n::alert{type=\"warning\"}\nN'ajoutez pas serverMiddleware au répertoire middleware/.\n\nMiddleware, sont regroupés par webpack dans votre bundle de production et exécutés sur beforeRouteEnter. Si vous ajoutez serverMiddleware au répertoire middleware/, il sera pris à tort par Nuxt en tant que middleware et ajoutera de mauvaises dépendances à votre bundle ou générera des erreurs.\n::\n## Utilisation\n\nSi le middleware est une chaîne de caractères, alors Nuxt essaiera de le résoudre automatiquement et le rendra requis.\n\n```js{}[nuxt.config.js]\nimport serveStatic from 'serve-static'\n\nexport default {\n  serverMiddleware: [\n    // Inscrira redirect-ssl dans les package npm\n    'redirect-ssl',\n\n    // Inscrira le fichier index du répertoire server-middleware pour gérer /server-middleware/*\n    { path: '/server-middleware', handler: '~/server-middleware/index.js' },\n\n    // Nous pouvons également créer des instances personnalisées\n    { path: '/static2', handler: serveStatic(__dirname + '/static2') }\n  ]\n}\n```\n\n::alert{type=\"warning\"}\nSi vous ne voulez pas que le middleware s'enregistre pour toutes les routes, vous devez l'utiliser sous la forme d'un Object avec un chemin d'accès spécifique, sinon le gestionnaire par défaut nuxt ne fonctionnera pas !\n::\n\n## Middleware de serveur personnalisé\n\nIl est également possible d'écrire des Middleware personnalisés. Pour plus d'informations, voir [Connect Docs](https://github.com/senchalabs/connect#appusefn).\n\nMiddleware (`server-middleware/logger.js`):\n\n```js{}[server-middleware/logger.js]\nexport default function (req, res, next) {\n  // req est l'objet de la requête http de Node.js\n  console.log(req.url)\n\n  // res est l'objet de réponse http de Node.js\n\n  // next est une fonction à appeler pour invoquer le prochain middleware\n  // N'oubliez pas d'appeler le suivant à la fin si votre middleware n'est pas un endpoint !\n  next()\n}\n```\n\n```js{}[nuxt.config.js]\nserverMiddleware: [`~/server-middleware/logger`]\n```\n\n## API endpoint personnalisé\n\nUn middleware de serveur peut également étendre Express. Cela permet la création d'endpoint REST.\n\n```js{}[server-middleware/rest.js]\nconst bodyParser = require('body-parser')\nconst app = require('express')()\n\napp.use(bodyParser.json())\napp.all('/getJSON', (req, res) => {\n  res.json({ data: 'data' })\n})\n\nmodule.exports = app\n```\n\n```js{}[nuxt.config.js]\nserverMiddleware: [\n  { path: \"/server-middleware\", handler: \"~/server-middleware/rest.js\" },\n],\n```\n\n## Syntaxe de l'objet\n\nSi le middleware de votre serveur est constitué d'une liste de fonctions mises en correspondance avec des chemins d'accès :\n\n```js\nexport default {\n  serverMiddleware: [\n    { path: '/a', handler: '~/server-middleware/a.js' },\n    { path: '/b', handler: '~/server-middleware/b.js' },\n    { path: '/c', handler: '~/server-middleware/c.js' }\n  ]\n}\n```\n\nVous pouvez aussi passer un objet pour les définir, comme suit :\n\n```js\nexport default {\n  serverMiddleware: {\n    '/a': '~/server-middleware/a.js',\n    '/b': '~/server-middleware/b.js',\n    '/c': '~/server-middleware/c.js'\n  }\n}\n```\n","ast":{"type":"root","children":[{"type":"element","tag":"prose-h1","props":{"class":"d-heading-title","id":"la-propriété-servermiddleware"},"children":[{"type":"text","value":"La propriété serverMiddleware"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{"class":"d-heading-description"},"children":[{"type":"text","value":"Défini le middleware côté serveur."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-hr","props":{"class":"d-heading-hr"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Type: "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Array"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Items: "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"String"}]},{"type":"text","value":" ou "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Object"}]},{"type":"text","value":" ou "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Function"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Nuxt crée en interne une instance "},{"type":"element","tag":"prose-a","props":{"href":"https://github.com/senchalabs/connect","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"connect"}]},{"type":"text","value":" à laquelle vous pouvez ajouter votre propre middleware personnalisé. Cela nous permet d'enregistrer des routes supplémentaires (généralement des routes "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"/api"}]},{"type":"text","value":") "},{"type":"element","tag":"prose-strong","props":{},"children":[{"type":"text","value":"sans avoir besoin d'un serveur externe"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Parce que Connect itself est un middleware, les middleware enregistrés fonctionneront avec "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"nuxt start"}]},{"type":"text","value":" et aussi lorsqu'il est utilisé comme un middleware avec des usages programmatiques comme "},{"type":"element","tag":"prose-a","props":{"href":"https://github.com/nuxt-community/express-template","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"express-template"}]},{"type":"text","value":". Les "},{"type":"element","tag":"prose-a","props":{"href":"/docs/directory-structure/modules"},"children":[{"type":"text","value":"Modules"}]},{"type":"text","value":" nuxt peuvent également fournir "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"serverMiddleware"}]},{"type":"text","value":" en utilisant "},{"type":"element","tag":"prose-a","props":{"href":"/docs/internals-glossary/internals-module-container#addservermiddleware-middleware"},"children":[{"type":"text","value":"this.addServerMiddleware()"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"En plus, nous avons introduit une option "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"prefix"}]},{"type":"text","value":" dont la valeur par défaut est "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"true"}]},{"type":"text","value":". Elle ajoutera la base du routeur aux middlewares de votre serveur."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-strong","props":{},"children":[{"type":"text","value":"Exemple:"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Chemin d'accès au middleware du serveur : "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"/server-middleware"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Base du routeur : "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"/admin"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Avec "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"prefix: true"}]},{"type":"text","value":" (par défaut): "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"/admin/server-middleware"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Avec "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"prefix: false"}]},{"type":"text","value":": "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"/server-middleware"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"servermiddleware-vs-middleware"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#servermiddleware-vs-middleware"},"children":[{"type":"text","value":"serverMiddleware vs middleware!"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Ne le confondez pas avec "},{"type":"element","tag":"prose-a","props":{"href":"/docs/directory-structure/middleware#router-middleware"},"children":[{"type":"text","value":"routes middleware"}]},{"type":"text","value":" qui sont appelés avant chaque route par Vue pour les rendu monopage ou SSR. Les Middleware listés dans la propriété "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"serverMiddleware"}]},{"type":"text","value":" s'exécutent côté serveur "},{"type":"element","tag":"prose-strong","props":{},"children":[{"type":"text","value":"avant"}]},{"type":"text","value":" "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"vue-server-renderer"}]},{"type":"text","value":" et peuvent être utilisés pour des tâches spécifiques au serveur comme le traitement des requêtes API ou pour le chargement des ressources."}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"warning"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"N'ajoutez pas serverMiddleware au répertoire middleware/."}]},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Middleware, sont regroupés par webpack dans votre bundle de production et exécutés sur beforeRouteEnter. Si vous ajoutez serverMiddleware au répertoire middleware/, il sera pris à tort par Nuxt en tant que middleware et ajoutera de mauvaises dépendances à votre bundle ou générera des erreurs."}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"utilisation"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#utilisation"},"children":[{"type":"text","value":"Utilisation"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Si le middleware est une chaîne de caractères, alors Nuxt essaiera de le résoudre automatiquement et le rendra requis."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"element","tag":"pre","props":{"className":["language-js","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"import"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","imports"]},"children":[{"type":"text","value":"serveStatic"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"from"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'serve-static'"}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  serverMiddleware"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// Inscrira redirect-ssl dans les package npm"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'redirect-ssl'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// Inscrira le fichier index du répertoire server-middleware pour gérer /server-middleware/*"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" path"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/server-middleware'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" handler"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'~/server-middleware/index.js'"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// Nous pouvons également créer des instances personnalisées"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" path"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/static2'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" handler"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"serveStatic"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"__dirname "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"+"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/static2'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"warning"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Si vous ne voulez pas que le middleware s'enregistre pour toutes les routes, vous devez l'utiliser sous la forme d'un Object avec un chemin d'accès spécifique, sinon le gestionnaire par défaut nuxt ne fonctionnera pas !"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"middleware-de-serveur-personnalisé"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#middleware-de-serveur-personnalis%C3%A9"},"children":[{"type":"text","value":"Middleware de serveur personnalisé"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Il est également possible d'écrire des Middleware personnalisés. Pour plus d'informations, voir "},{"type":"element","tag":"prose-a","props":{"href":"https://github.com/senchalabs/connect#appusefn","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"Connect Docs"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Middleware ("},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"server-middleware/logger.js"}]},{"type":"text","value":"):"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"server-middleware/logger.js"}]},{"type":"element","tag":"pre","props":{"className":["language-js","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"function"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","parameter"]},"children":[{"type":"text","value":"req"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" res"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" next"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// req est l'objet de la requête http de Node.js"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","console","class-name"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"req"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"url"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n\n  "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// res est l'objet de réponse http de Node.js"}]},{"type":"text","value":"\n\n  "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// next est une fonction à appeler pour invoquer le prochain middleware"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// N'oubliez pas d'appeler le suivant à la fin si votre middleware n'est pas un endpoint !"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"next"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"element","tag":"pre","props":{"className":["language-js","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"serverMiddleware"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"className":["token","template-string"]},"children":[{"type":"element","tag":"span","props":{"className":["token","template-punctuation","string"]},"children":[{"type":"text","value":"`"}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"~/server-middleware/logger"}]},{"type":"element","tag":"span","props":{"className":["token","template-punctuation","string"]},"children":[{"type":"text","value":"`"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"api-endpoint-personnalisé"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#api-endpoint-personnalis%C3%A9"},"children":[{"type":"text","value":"API endpoint personnalisé"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Un middleware de serveur peut également étendre Express. Cela permet la création d'endpoint REST."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"server-middleware/rest.js"}]},{"type":"element","tag":"pre","props":{"className":["language-js","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"const"}]},{"type":"text","value":" bodyParser "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"require"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'body-parser'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"const"}]},{"type":"text","value":" app "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"require"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'express'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n\napp"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"use"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"bodyParser"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\napp"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"all"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/getJSON'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","parameter"]},"children":[{"type":"text","value":"req"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" res"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","arrow","operator"]},"children":[{"type":"text","value":"=>"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  res"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" data"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'data'"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n\nmodule"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"exports"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" app\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"element","tag":"pre","props":{"className":["language-js","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"serverMiddleware"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" path"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\"/server-middleware\""}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" handler"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\"~/server-middleware/rest.js\""}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"syntaxe-de-lobjet"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#syntaxe-de-lobjet"},"children":[{"type":"text","value":"Syntaxe de l'objet"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Si le middleware de votre serveur est constitué d'une liste de fonctions mises en correspondance avec des chemins d'accès :"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["language-js","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  serverMiddleware"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" path"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/a'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" handler"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'~/server-middleware/a.js'"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" path"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/b'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" handler"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'~/server-middleware/b.js'"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":" path"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/c'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" handler"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'~/server-middleware/c.js'"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Vous pouvez aussi passer un objet pour les définir, comme suit :"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["language-js","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  serverMiddleware"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/a'"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'~/server-middleware/a.js'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/b'"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'~/server-middleware/b.js'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'/c'"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'~/server-middleware/c.js'"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]}]},"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"servermiddleware-vs-middleware","depth":2,"text":"serverMiddleware vs middleware!"},{"id":"utilisation","depth":2,"text":"Utilisation"},{"id":"middleware-de-serveur-personnalisé","depth":2,"text":"Middleware de serveur personnalisé"},{"id":"api-endpoint-personnalisé","depth":2,"text":"API endpoint personnalisé"},{"id":"syntaxe-de-lobjet","depth":2,"text":"Syntaxe de l'objet"}]}}}