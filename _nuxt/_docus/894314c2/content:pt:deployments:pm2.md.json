{"key":"content:pt:deployments:pm2.md","generatedAt":"2022-03-15T12:18:30.886Z","mtime":"2022-03-15T12:18:30.880Z","slug":"pm2","title":"PM2","position":"999999999999","to":"/pt/deployments/pm2","draft":false,"page":true,"language":"en","template":"guide","description":"Como desdobrar o Nuxt com o de agrupamento do PM2 ativado?","target":"Server","category":"deployment","logo":{"light":"/img/companies/square/light/pm2.png","dark":"/img/companies/square/dark/pm2.png"},"empty":false,"body":{"raw":"---\ntemplate: guide\ntitle: PM2\ndescription: Como desdobrar o Nuxt com o de agrupamento do PM2 ativado?\ntarget: Server\ncategory: deployment\nlogo:\n  light: \"/img/companies/square/light/pm2.png\"\n  dark: \"/img/companies/square/dark/pm2.png\"\n---\n# Desdobrar o Nuxt usando o PM2\n\nComo desdobrar o Nuxt com o de agrupamento do PM2 ativado?\n\n---\n\nO desdobrando usando [PM2](https://pm2.keymetrics.io/) (Process Manager 2, Gestor de Processos 2) é uma solução rápida e fácil para hospedagem da sua aplicação Nuxt universal no seu servidor ou VM.\n\nNeste guia, nós construímos a aplicação localmente e servimos ela com um ficheiro de configuração do PM2 com o modo de agrupamento ativado. O modo de agrupamento irá prevenir o tempo de espera ao permitir com que as aplicações sejam escaladas através de várias CPUs.\n\n## Vamos começar\n\nCertifique-se que você tem o pm2 instalado no seu servidor. Se não, simplesmente instale ele globalmente a partir do yarn ou npm.\n\n```bash\n# yarn pm2 install\n$ sudo yarn global add pm2 --prefix /usr/local\n\n# npm pm2 install\n$ npm install pm2 -g\n```\n\n## Configure a sua aplicação\n\nTodo o que você precisa para adicionar a sua aplicação Nuxt universal para servir ela é o PM2 que é um ficheiro chamado `ecosystem.config.js`. Crie um novo ficheiro com aquele nome dentro da raíz do diretório do seu projeto e adicione o seguinte conteúdo:\n\n```javascript\nmodule.exports = {\n  apps: [\n    {\n      name: 'NuxtAppName',\n      exec_mode: 'cluster',\n      instances: 'max', // Ou um número de instâncias\n      script: './node_modules/nuxt/bin/nuxt.js',\n      args: 'start'\n    }\n  ]\n}\n```\n\n## Construa e sirva a aplicação\n\nAgora construa sua aplicação com `npm run build`.\n\nE sirva ela com `pm2 start`.\n\nConsulte os estados `pm2 ls`.\n\nAgora a sua aplicação Nuxt está sendo servida!\n\n## Informações adicionais\n\nEsta solução garante, sem tempo de espera para a sua aplicação neste servidor. (Você deve também prevenir a falha no servidor através de redundância ou soluções de nuvem de alta disponibilidade.)\n\nVocê pode encontrar configurações adicionais do PM2 [aqui](https://pm2.keymetrics.io/docs/usage/application-declaration/#general).\n","ast":{"type":"root","children":[{"type":"element","tag":"prose-h1","props":{"class":"d-heading-title","id":"desdobrar-o-nuxt-usando-o-pm2"},"children":[{"type":"text","value":"Desdobrar o Nuxt usando o PM2"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{"class":"d-heading-description"},"children":[{"type":"text","value":"Como desdobrar o Nuxt com o de agrupamento do PM2 ativado?"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-hr","props":{"class":"d-heading-hr"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"O desdobrando usando "},{"type":"element","tag":"prose-a","props":{"href":"https://pm2.keymetrics.io/","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"PM2"}]},{"type":"text","value":" (Process Manager 2, Gestor de Processos 2) é uma solução rápida e fácil para hospedagem da sua aplicação Nuxt universal no seu servidor ou VM."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Neste guia, nós construímos a aplicação localmente e servimos ela com um ficheiro de configuração do PM2 com o modo de agrupamento ativado. O modo de agrupamento irá prevenir o tempo de espera ao permitir com que as aplicações sejam escaladas através de várias CPUs."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"vamos-começar"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#vamos-come%C3%A7ar"},"children":[{"type":"text","value":"Vamos começar"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Certifique-se que você tem o pm2 instalado no seu servidor. Se não, simplesmente instale ele globalmente a partir do yarn ou npm."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-bash"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# yarn pm2 install"}]},{"type":"text","value":"\n$ "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"sudo"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"yarn"}]},{"type":"text","value":" global "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"add"}]},{"type":"text","value":" pm2 --prefix /usr/local\n\n"},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# npm pm2 install"}]},{"type":"text","value":"\n$ "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"npm"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"install"}]},{"type":"text","value":" pm2 -g\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"configure-a-sua-aplicação"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#configure-a-sua-aplica%C3%A7%C3%A3o"},"children":[{"type":"text","value":"Configure a sua aplicação"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Todo o que você precisa para adicionar a sua aplicação Nuxt universal para servir ela é o PM2 que é um ficheiro chamado "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"ecosystem.config.js"}]},{"type":"text","value":". Crie um novo ficheiro com aquele nome dentro da raíz do diretório do seu projeto e adicione o seguinte conteúdo:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-javascript"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"module"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"exports"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  apps"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      name"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'NuxtAppName'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      exec_mode"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'cluster'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      instances"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'max'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// Ou um número de instâncias"}]},{"type":"text","value":"\n      script"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'./node_modules/nuxt/bin/nuxt.js'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n      args"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'start'"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"construa-e-sirva-a-aplicação"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#construa-e-sirva-a-aplica%C3%A7%C3%A3o"},"children":[{"type":"text","value":"Construa e sirva a aplicação"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Agora construa sua aplicação com "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"npm run build"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"E sirva ela com "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"pm2 start"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Consulte os estados "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"pm2 ls"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Agora a sua aplicação Nuxt está sendo servida!"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"informações-adicionais"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#informa%C3%A7%C3%B5es-adicionais"},"children":[{"type":"text","value":"Informações adicionais"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Esta solução garante, sem tempo de espera para a sua aplicação neste servidor. (Você deve também prevenir a falha no servidor através de redundância ou soluções de nuvem de alta disponibilidade.)"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Você pode encontrar configurações adicionais do PM2 "},{"type":"element","tag":"prose-a","props":{"href":"https://pm2.keymetrics.io/docs/usage/application-declaration/#general","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"aqui"}]},{"type":"text","value":"."}]}]},"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"vamos-começar","depth":2,"text":"Vamos começar"},{"id":"configure-a-sua-aplicação","depth":2,"text":"Configure a sua aplicação"},{"id":"construa-e-sirva-a-aplicação","depth":2,"text":"Construa e sirva a aplicação"},{"id":"informações-adicionais","depth":2,"text":"Informações adicionais"}]}}}