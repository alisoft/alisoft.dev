{"key":"content:ja:deployments:nginx.md","generatedAt":"2022-03-15T12:18:28.687Z","mtime":"2022-03-15T12:18:28.672Z","slug":"nginx","title":"NGINX","position":"999999990000","to":"/deployments/nginx","draft":false,"page":true,"language":"ja","template":"guide","description":"リバースプロキシとして NGINX の使い方","target":"Static & Server","category":"deployment","logo":{"light":"/img/companies/square/light/Nginx.svg","dark":"/img/companies/square/dark/Nginx.svg"},"empty":false,"body":{"raw":"---\ntemplate: guide\ntitle: NGINX\ndescription: リバースプロキシとして NGINX の使い方\ntarget: Static & Server\ncategory: deployment\nlogo:\n  light: \"/img/companies/square/light/Nginx.svg\"\n  dark: \"/img/companies/square/dark/Nginx.svg\"\n---\n# リバースプロキシとして NGINX を使う\n\nリバースプロキシとして NGINX の使い方\n\n---\n\n```nginx\nmap $sent_http_content_type $expires {\n    \"text/html\"                 epoch;\n    \"text/html; charset=utf-8\"  epoch;\n    default                     off;\n}\n\nserver {\n    listen          80;             # nginxがリッスンしているポート\n    server_name     your-domain;    # ここにドメインをセットアップ\n\n    gzip            on;\n    gzip_types      text/plain application/xml text/css application/javascript;\n    gzip_min_length 1000;\n\n    location / {\n        expires $expires;\n\n        proxy_redirect                      off;\n        proxy_set_header Host               $host;\n        proxy_set_header X-Real-IP          $remote_addr;\n        proxy_set_header X-Forwarded-For    $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto  $scheme;\n        proxy_read_timeout          1m;\n        proxy_connect_timeout       1m;\n        proxy_pass                          http://127.0.0.1:3000; # ここに Node.js インスタンスのアドレスを設定\n    }\n}\n```\n\n## 生成されたページとフォールバックとしてキャッシングプロキシを使用した nginx\n\nコンテンツが定期的に変更される大容量のウェブサイトをお持ちの場合、Nuxt の生成機能と[nginx caching](https://www.nginx.com/blog/nginx-caching-guide)の恩恵を受けることができるでしょう。\n\n以下に設定例を示します。覚えてください：\n\n- ルートフォルダは、[generate.dir の設定](/docs/configuration-glossary/configuration-generate#dir)で設定したものと同じである必要があります。\n- Nuxt で設定された期限切れのヘッダーは削除されます（キャッシュがあるため）。\n- Nuxt と nginx の両方で追加のヘッダーを設定できますが、どちらかを選択することをお勧めします（迷ったら nginx を選択してください）。\n- サイトのほとんどが静的なものであれば、`proxy_cache_path inactive` と `proxy_cache_valid` の値を増やしてください。\n\nルートを生成しなくても、nginx のキャッシュの恩恵を受けたい場合：\n\n- `root` エントリを削除\n- `location @proxy {` を `location / {` に変更\n- 他 2 `location` エントリを削除\n\n```nginx\nproxy_cache_path  /data/nginx/cache levels=1:2 keys_zone=nuxt-cache:25m max_size=1g inactive=60m use_temp_path=off;\n\nmap $sent_http_content_type $expires {\n    \"text/html\"                 1h; # これが必要なら設定\n    \"text/html; charset=utf-8\"  1h; # これが必要なら設定\n    default                     7d; # これが必要なら設定\n}\n\nserver {\n    listen          80;             # nginx がリッスンするポート\n    server_name     your-domain;    # ここにドメインをセットアップ\n\n    gzip            on;\n    gzip_types      text/plain application/xml text/css application/javascript;\n    gzip_min_length 1000;\n\n    charset utf-8;\n\n    root /var/www/NUXT_PROJECT_PATH/dist;\n\n    location ~* \\.(?:ico|gif|jpe?g|png|woff2?|eot|otf|ttf|svg|js|css)$ {\n        expires $expires;\n        add_header Pragma public;\n        add_header Cache-Control \"public\";\n\n        try_files $uri $uri/ @proxy;\n    }\n\n    location / {\n        expires $expires;\n        add_header Content-Security-Policy \"default-src 'self' 'unsafe-inline';\";\n        add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\" always;\n        add_header X-Frame-Options \"SAMEORIGIN\";\n\n        try_files $uri $uri/index.html @proxy; # generate.subFolders: true 向け\n        # try_files $uri $uri.html @proxy; # generate.subFolders: false 向け\n    }\n\n    location @proxy {\n        expires $expires;\n        add_header Content-Security-Policy \"default-src 'self' 'unsafe-inline';\";\n        add_header Strict-Transport-Security \"max-age=31536000; includeSubDomains; preload\" always;\n        add_header X-Frame-Options \"SAMEORIGIN\";\n        add_header X-Cache-Status $upstream_cache_status;\n\n        proxy_redirect                      off;\n        proxy_set_header Host               $host;\n        proxy_set_header X-Real-IP          $remote_addr;\n        proxy_set_header X-Forwarded-For    $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto  $scheme;\n        proxy_ignore_headers        Cache-Control;\n        proxy_http_version          1.1;\n        proxy_read_timeout          1m;\n        proxy_connect_timeout       1m;\n        proxy_pass                  http://127.0.0.1:3000; # ここに Node.js インスタンスのアドレスを設定\n        proxy_cache                 nuxt-cache;\n        proxy_cache_bypass          $arg_nocache; # これは変更した方がよいでしょう\n        proxy_cache_valid           200 302  60m; # これが必要なら設定\n        proxy_cache_valid           404      1m;  # これが必要なら設定\n        proxy_cache_lock            on;\n        proxy_cache_use_stale error timeout http_500 http_502 http_503 http_504;\n        proxy_cache_key             $uri$is_args$args;\n    }\n}\n```\n\n## #Laravel Forge 向けの nginx 設定:\n\n`YOUR_WEBSITE_FOLDER` をウェブサイトのフォルダに、`YOUR_WEBSITE_DOMAIN` をウェブサイトのURLに変更してください。Laravel Forge がこれらの値を入力してくれていますが、必ず再確認してください。\n\n```nginx\n# FORGE 設定 (削除しないでください！)\ninclude forge-conf/YOUR_WEBSITE_FOLDER/before/*;\n\nmap $sent_http_content_type $expires {\n    \"text/html\"                 epoch;\n    \"text/html; charset=utf-8\"  epoch;\n    default                     off;\n}\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name YOUR_WEBSITE_DOMAIN;\n\n    add_header X-Frame-Options \"SAMEORIGIN\";\n    add_header X-XSS-Protection \"1; mode=block\";\n    add_header X-Content-Type-Options \"nosniff\";\n\n    charset utf-8;\n\n    gzip            on;\n    gzip_types      text/plain application/xml text/css application/javascript;\n    gzip_min_length 1000;\n\n    # FORGE 設定 (削除しないでください！)\n    include forge-conf/YOUR_WEBSITE_FOLDER/server/*;\n\n    location / {\n        expires $expires;\n\n        proxy_redirect off;\n        proxy_set_header Host               $host;\n        proxy_set_header X-Real-IP          $remote_addr;\n        proxy_set_header X-Forwarded-For    $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto  $scheme;\n        proxy_read_timeout          1m;\n        proxy_connect_timeout       1m;\n        proxy_pass                          http://127.0.0.1:3000; # ここに Node.js インスタンスのアドレスを設定\n    }\n\n    access_log off;\n    error_log  /var/log/nginx/YOUR_WEBSITE_FOLDER-error.log error;\n\n    location ~ /\\.(?!well-known).* {\n        deny all;\n    }\n}\n\n# FORGE 設定 (削除しないでください！)\ninclude forge-conf/YOUR_WEBSITE_FOLDER/after/*;\n```\n\n## TLS で Laravel Forgeをセキュアにする\n\nLaravel Forge に `nginx.conf` の編集を任せるのが一番良いでしょう、Sitesをクリックして → YOUR_WEBSITE_DOMAIN（SERVER_NAME）をクリックし、SSL をクリックして、いずれかのプロバイダーの証明書をインストールします。証明書を有効にすることを忘れないでください。これであなたの `nginx.conf` は以下のようになるはずです：\n\n```nginx\n# FORGE 設定 (削除しないでください！)\ninclude forge-conf/YOUR_WEBSITE_FOLDER/before/*;\n\nmap $sent_http_content_type $expires {\n    \"text/html\"                 epoch;\n    \"text/html; charset=utf-8\"  epoch;\n    default                     off;\n}\n\nserver {\n    listen 443 ssl http2;\n    listen [::]:443 ssl http2;\n    server_name YOUR_WEBSITE_DOMAIN;\n\n    # FORGE 設定 (削除しないでください！)\n    ssl_certificate /etc/nginx/ssl/YOUR_WEBSITE_FOLDER/258880/server.crt;\n    ssl_certificate_key /etc/nginx/ssl/YOUR_WEBSITE_FOLDER/258880/server.key;\n\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers 'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA:!3DES';\n    ssl_prefer_server_ciphers on;\n    ssl_dhparam /etc/nginx/dhparams.pem;\n\n    add_header X-Frame-Options \"SAMEORIGIN\";\n    add_header X-XSS-Protection \"1; mode=block\";\n    add_header X-Content-Type-Options \"nosniff\";\n\n    charset utf-8;\n\n    gzip            on;\n    gzip_types      text/plain application/xml text/css application/javascript;\n    gzip_min_length 1000;\n\n    # FORGE 設定 (削除しないでください！)\n    include forge-conf/YOUR_WEBSITE_FOLDER/server/*;\n\n    location / {\n        expires $expires;\n\n        proxy_set_header Host               $host;\n        proxy_set_header X-Real-IP          $remote_addr;\n        proxy_set_header X-Forwarded-For    $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto  $scheme;\n        proxy_redirect              off;\n        proxy_read_timeout          1m;\n        proxy_connect_timeout       1m;\n        proxy_pass                          http://127.0.0.1:3000; # ここに Node.js インスタンスのアドレスを設定\n    }\n\n    access_log off;\n    error_log  /var/log/nginx/YOUR_WEBSITE_FOLDER-error.log error;\n\n    location ~ /\\.(?!well-known).* {\n        deny all;\n    }\n}\n\n# FORGE 設定 (削除しないでください！)\ninclude forge-conf/YOUR_WEBSITE_FOLDER/after/*;\n```\n","ast":{"type":"root","children":[{"type":"element","tag":"prose-h1","props":{"class":"d-heading-title","id":"リバースプロキシとして-nginx-を使う"},"children":[{"type":"text","value":"リバースプロキシとして NGINX を使う"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{"class":"d-heading-description"},"children":[{"type":"text","value":"リバースプロキシとして NGINX の使い方"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-hr","props":{"class":"d-heading-hr"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["language-nginx","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"map"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$sent_http_content_type"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    \"text/html\"                 "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"epoch"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    \"text/html"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" charset=utf-8\"  "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"epoch"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":"                     "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"off"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"server"}]}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"listen"}]},{"type":"text","value":"          "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"80"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"             "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# nginxがリッスンしているポート"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"server_name"}]},{"type":"text","value":"     your-domain"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"    "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# ここにドメインをセットアップ"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"gzip"}]},{"type":"text","value":"            "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"on"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"gzip_types"}]},{"type":"text","value":"      text/plain application/xml text/css application/javascript"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"gzip_min_length"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1000"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"location"}]},{"type":"text","value":" /"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"expires"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_redirect"}]},{"type":"text","value":"                      "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"off"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" Host               "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$host"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Real-IP          "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$remote_addr"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Forwarded-For    "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$proxy_add_x_forwarded_for"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Forwarded-Proto  "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$scheme"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_read_timeout"}]},{"type":"text","value":"          "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_connect_timeout"}]},{"type":"text","value":"       "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_pass"}]},{"type":"text","value":"                          http://127.0.0.1:3000"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# ここに Node.js インスタンスのアドレスを設定"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"生成されたページとフォールバックとしてキャッシングプロキシを使用した-nginx"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#%E7%94%9F%E6%88%90%E3%81%95%E3%82%8C%E3%81%9F%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%A8%E3%83%95%E3%82%A9%E3%83%BC%E3%83%AB%E3%83%90%E3%83%83%E3%82%AF%E3%81%A8%E3%81%97%E3%81%A6%E3%82%AD%E3%83%A3%E3%83%83%E3%82%B7%E3%83%B3%E3%82%B0%E3%83%97%E3%83%AD%E3%82%AD%E3%82%B7%E3%82%92%E4%BD%BF%E7%94%A8%E3%81%97%E3%81%9F-nginx"},"children":[{"type":"text","value":"生成されたページとフォールバックとしてキャッシングプロキシを使用した nginx"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"コンテンツが定期的に変更される大容量のウェブサイトをお持ちの場合、Nuxt の生成機能と"},{"type":"element","tag":"prose-a","props":{"href":"https://www.nginx.com/blog/nginx-caching-guide","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"nginx caching"}]},{"type":"text","value":"の恩恵を受けることができるでしょう。"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"以下に設定例を示します。覚えてください："}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"ルートフォルダは、"},{"type":"element","tag":"prose-a","props":{"href":"/docs/configuration-glossary/configuration-generate#dir"},"children":[{"type":"text","value":"generate.dir の設定"}]},{"type":"text","value":"で設定したものと同じである必要があります。"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Nuxt で設定された期限切れのヘッダーは削除されます（キャッシュがあるため）。"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Nuxt と nginx の両方で追加のヘッダーを設定できますが、どちらかを選択することをお勧めします（迷ったら nginx を選択してください）。"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"サイトのほとんどが静的なものであれば、"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"proxy_cache_path inactive"}]},{"type":"text","value":" と "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"proxy_cache_valid"}]},{"type":"text","value":" の値を増やしてください。"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"ルートを生成しなくても、nginx のキャッシュの恩恵を受けたい場合："}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"root"}]},{"type":"text","value":" エントリを削除"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"location @proxy {"}]},{"type":"text","value":" を "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"location / {"}]},{"type":"text","value":" に変更"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"他 2 "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"location"}]},{"type":"text","value":" エントリを削除"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["language-nginx","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_cache_path"}]},{"type":"text","value":"  /data/nginx/cache levels=1:2 keys_zone=nuxt-cache:25m max_size=1g inactive=60m use_temp_path=off"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"map"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$sent_http_content_type"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    \"text/html\"                 "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"1h"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# これが必要なら設定"}]},{"type":"text","value":"\n    \"text/html"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"charset=utf-8\""}]},{"type":"text","value":"  1h; "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# これが必要なら設定"}]},{"type":"text","value":"\n    default                     7d; "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# これが必要なら設定"}]},{"type":"text","value":"\n}\n\nserver {\n    listen          80;             "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# nginx がリッスンするポート"}]},{"type":"text","value":"\n    server_name     your-domain;    "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# ここにドメインをセットアップ"}]},{"type":"text","value":"\n\n    gzip            on;\n    gzip_types      text/plain application/xml text/css application/javascript;\n    gzip_min_length 1000;\n\n    charset utf-8;\n\n    root /var/www/NUXT_PROJECT_PATH/dist;\n\n    location ~* \\.(?:ico|gif|jpe?g|png|woff2?|eot|otf|ttf|svg|js|css)$ {\n        expires "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]},{"type":"text","value":";\n        add_header Pragma public;\n        add_header Cache-Control \"public"},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\";\n\n        try_files "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$uri"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$uri"}]},{"type":"text","value":"/ @proxy;\n    }\n\n    location / {\n        expires "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]},{"type":"text","value":";\n        add_header Content-Security-Policy \""}]},{"type":"text","value":"default-src "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'self'"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'unsafe-inline'"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\""},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"add_header"}]},{"type":"text","value":" Strict-Transport-Security "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\"max-age=31536000; includeSubDomains; preload\""}]},{"type":"text","value":" always"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"add_header"}]},{"type":"text","value":" X-Frame-Options "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\"SAMEORIGIN\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"try_files"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$uri"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$uri"}]},{"type":"text","value":"/index.html @proxy"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# generate.subFolders: true 向け"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# try_files $uri $uri.html @proxy; # generate.subFolders: false 向け"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"location"}]},{"type":"text","value":" @proxy"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"expires"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"add_header"}]},{"type":"text","value":" Content-Security-Policy "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\"default-src 'self' 'unsafe-inline';\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"add_header"}]},{"type":"text","value":" Strict-Transport-Security "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\"max-age=31536000; includeSubDomains; preload\""}]},{"type":"text","value":" always"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"add_header"}]},{"type":"text","value":" X-Frame-Options "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\"SAMEORIGIN\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"add_header"}]},{"type":"text","value":" X-Cache-Status "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$upstream_cache_status"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_redirect"}]},{"type":"text","value":"                      "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"off"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" Host               "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$host"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Real-IP          "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$remote_addr"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Forwarded-For    "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$proxy_add_x_forwarded_for"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Forwarded-Proto  "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$scheme"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_ignore_headers"}]},{"type":"text","value":"        Cache-Control"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_http_version"}]},{"type":"text","value":"          1.1"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_read_timeout"}]},{"type":"text","value":"          "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_connect_timeout"}]},{"type":"text","value":"       "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_pass"}]},{"type":"text","value":"                  http://127.0.0.1:3000"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# ここに Node.js インスタンスのアドレスを設定"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_cache"}]},{"type":"text","value":"                 nuxt-cache"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_cache_bypass"}]},{"type":"text","value":"          "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$arg_nocache"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# これは変更した方がよいでしょう"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_cache_valid"}]},{"type":"text","value":"           "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"200"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"302"}]},{"type":"text","value":"  "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"60m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# これが必要なら設定"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_cache_valid"}]},{"type":"text","value":"           "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"404"}]},{"type":"text","value":"      "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"  "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# これが必要なら設定"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_cache_lock"}]},{"type":"text","value":"            "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"on"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_cache_use_stale"}]},{"type":"text","value":" error timeout http_500 http_502 http_503 http_504"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_cache_key"}]},{"type":"text","value":"             "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$uri"}]},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$is_args"}]},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$args"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"laravel-forge-向けの-nginx-設定"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#laravel-forge-%E5%90%91%E3%81%91%E3%81%AE-nginx-%E8%A8%AD%E5%AE%9A"},"children":[{"type":"text","value":"#Laravel Forge 向けの nginx 設定:"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"YOUR_WEBSITE_FOLDER"}]},{"type":"text","value":" をウェブサイトのフォルダに、"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"YOUR_WEBSITE_DOMAIN"}]},{"type":"text","value":" をウェブサイトのURLに変更してください。Laravel Forge がこれらの値を入力してくれていますが、必ず再確認してください。"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["language-nginx","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# FORGE 設定 (削除しないでください！)"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"include"}]},{"type":"text","value":" forge-conf/YOUR_WEBSITE_FOLDER/before/*"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"map"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$sent_http_content_type"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    \"text/html\"                 "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"epoch"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    \"text/html"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"charset=utf-8\""}]},{"type":"text","value":"  epoch;\n    default                     off;\n}\n\nserver {\n    listen 80;\n    listen [::]:80;\n    server_name YOUR_WEBSITE_DOMAIN;\n\n    add_header X-Frame-Options \"SAMEORIGIN"},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\";\n    add_header X-XSS-Protection \""}]},{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" mode=block\""},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"add_header"}]},{"type":"text","value":" X-Content-Type-Options "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\"nosniff\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"charset"}]},{"type":"text","value":" utf-8"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"gzip"}]},{"type":"text","value":"            "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"on"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"gzip_types"}]},{"type":"text","value":"      text/plain application/xml text/css application/javascript"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"gzip_min_length"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1000"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# FORGE 設定 (削除しないでください！)"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"include"}]},{"type":"text","value":" forge-conf/YOUR_WEBSITE_FOLDER/server/*"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"location"}]},{"type":"text","value":" /"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"expires"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_redirect"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"off"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" Host               "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$host"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Real-IP          "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$remote_addr"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Forwarded-For    "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$proxy_add_x_forwarded_for"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Forwarded-Proto  "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$scheme"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_read_timeout"}]},{"type":"text","value":"          "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_connect_timeout"}]},{"type":"text","value":"       "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_pass"}]},{"type":"text","value":"                          http://127.0.0.1:3000"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# ここに Node.js インスタンスのアドレスを設定"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"access_log"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"off"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"error_log"}]},{"type":"text","value":"  /var/log/nginx/YOUR_WEBSITE_FOLDER-error.log error"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"location"}]},{"type":"text","value":" ~ /\\.(?!well-known).*"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"deny"}]},{"type":"text","value":" all"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# FORGE 設定 (削除しないでください！)"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"include"}]},{"type":"text","value":" forge-conf/YOUR_WEBSITE_FOLDER/after/*"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"tls-で-laravel-forgeをセキュアにする"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#tls-%E3%81%A7-laravel-forge%E3%82%92%E3%82%BB%E3%82%AD%E3%83%A5%E3%82%A2%E3%81%AB%E3%81%99%E3%82%8B"},"children":[{"type":"text","value":"TLS で Laravel Forgeをセキュアにする"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Laravel Forge に "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"nginx.conf"}]},{"type":"text","value":" の編集を任せるのが一番良いでしょう、Sitesをクリックして → YOUR_WEBSITE_DOMAIN（SERVER_NAME）をクリックし、SSL をクリックして、いずれかのプロバイダーの証明書をインストールします。証明書を有効にすることを忘れないでください。これであなたの "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"nginx.conf"}]},{"type":"text","value":" は以下のようになるはずです："}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["language-nginx","line-numbers"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# FORGE 設定 (削除しないでください！)"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"include"}]},{"type":"text","value":" forge-conf/YOUR_WEBSITE_FOLDER/before/*"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"map"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$sent_http_content_type"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    \"text/html\"                 "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"epoch"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    \"text/html"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"charset=utf-8\""}]},{"type":"text","value":"  epoch;\n    default                     off;\n}\n\nserver {\n    listen "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"443"}]},{"type":"text","value":" ssl http2;\n    listen [::]:443 ssl http2;\n    server_name YOUR_WEBSITE_DOMAIN;\n\n    "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# FORGE 設定 (削除しないでください！)"}]},{"type":"text","value":"\n    ssl_certificate /etc/nginx/ssl/YOUR_WEBSITE_FOLDER/258880/server.crt;\n    ssl_certificate_key /etc/nginx/ssl/YOUR_WEBSITE_FOLDER/258880/server.key;\n\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA:!3DES'"}]},{"type":"text","value":";\n    ssl_prefer_server_ciphers on;\n    ssl_dhparam /etc/nginx/dhparams.pem;\n\n    add_header X-Frame-Options \"SAMEORIGIN"},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\";\n    add_header X-XSS-Protection \""}]},{"type":"text","value":"1"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" mode=block\""},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"add_header"}]},{"type":"text","value":" X-Content-Type-Options "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"\"nosniff\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"charset"}]},{"type":"text","value":" utf-8"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"gzip"}]},{"type":"text","value":"            "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"on"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"gzip_types"}]},{"type":"text","value":"      text/plain application/xml text/css application/javascript"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"gzip_min_length"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1000"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# FORGE 設定 (削除しないでください！)"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"include"}]},{"type":"text","value":" forge-conf/YOUR_WEBSITE_FOLDER/server/*"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"location"}]},{"type":"text","value":" /"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"expires"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$expires"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" Host               "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$host"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Real-IP          "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$remote_addr"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Forwarded-For    "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$proxy_add_x_forwarded_for"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_set_header"}]},{"type":"text","value":" X-Forwarded-Proto  "},{"type":"element","tag":"span","props":{"className":["token","variable"]},"children":[{"type":"text","value":"$scheme"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_redirect"}]},{"type":"text","value":"              "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"off"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_read_timeout"}]},{"type":"text","value":"          "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_connect_timeout"}]},{"type":"text","value":"       "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"1m"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"proxy_pass"}]},{"type":"text","value":"                          http://127.0.0.1:3000"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# ここに Node.js インスタンスのアドレスを設定"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"access_log"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"off"}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"error_log"}]},{"type":"text","value":"  /var/log/nginx/YOUR_WEBSITE_FOLDER-error.log error"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n\n    "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"location"}]},{"type":"text","value":" ~ /\\.(?!well-known).*"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"deny"}]},{"type":"text","value":" all"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# FORGE 設定 (削除しないでください！)"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","directive"]},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"include"}]},{"type":"text","value":" forge-conf/YOUR_WEBSITE_FOLDER/after/*"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":";"}]},{"type":"text","value":"\n"}]}]}]}]},"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"生成されたページとフォールバックとしてキャッシングプロキシを使用した-nginx","depth":2,"text":"生成されたページとフォールバックとしてキャッシングプロキシを使用した nginx"},{"id":"laravel-forge-向けの-nginx-設定","depth":2,"text":"#Laravel Forge 向けの nginx 設定:"},{"id":"tls-で-laravel-forgeをセキュアにする","depth":2,"text":"TLS で Laravel Forgeをセキュアにする"}]}}}