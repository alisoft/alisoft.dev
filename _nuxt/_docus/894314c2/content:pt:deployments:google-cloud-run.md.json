{"key":"content:pt:deployments:google-cloud-run.md","generatedAt":"2022-03-15T12:18:30.825Z","mtime":"2022-03-15T12:18:30.817Z","slug":"google-cloud-run","title":"Google Cloud Run","position":"999999999999","to":"/pt/deployments/google-cloud-run","draft":false,"page":true,"language":"en","template":"guide","description":"Como desdobrar o Nuxt no Google Cloud Run?","target":"Server","category":"deployment","logo":{"light":"/img/companies/square/light/Google_Cloud_run.svg","dark":"/img/companies/square/dark/Google_Cloud_run.svg"},"empty":false,"body":{"raw":"---\ntemplate: guide\ntitle: Google Cloud Run\ndescription: Como desdobrar o Nuxt no Google Cloud Run?\ntarget: Server\ncategory: deployment\nlogo:\n  light: \"/img/companies/square/light/Google_Cloud_run.svg\"\n  dark: \"/img/companies/square/dark/Google_Cloud_run.svg\"\n---\n# Desdobrar o Nuxt no Google Cloud Run\n\nComo desdobrar o Nuxt no Google Cloud Run?\n\n---\n\nO [Google Cloud Run](https://cloud.google.com/run) é uma plataforma de computação completamente gerida para desdobramento e escalamento de aplicações rapidamente e seguramente adicionadas em contentores.\n\nNeste guia, nós simplesmente carregamos a pasta inteira do projeto para o Google Cloud Build com um `Dockerfile`. Depois de carregar, o Cloud Build gerará automaticamente um contentor. Depois nós desdobraremos este contentor para o Google Cloud Run o qual iniciará ele com o script `start` dentro do nosso `package.json`.\n\n## Pontapé de Saída\n\nCertifique-se de que você tem uma conta no Google Cloud, um projeto e os acessos como editor no Cloud Build e no Cloud Run. Além disso, certifique-se de descarregar e instalar a interface de linha de comando do Cloud SDK a partir do Google como explicado [aqui](https://cloud.google.com/sdk/) e inicie a sessão com a sua conta do Google Cloud. Se você não quiser descarregar o Cloud SDK esteja ciente de que você pode usar a interface de linha de comando `gcloud` a partir do Google Cloud Console.\n\nAgora, vamos fazer algumas verificações!\n\nSe a API do Cloud Build e a API do Cloud Run não estiverem ativadas, ative elas:\n\n```bash\n# Ativando o Cloud Build\n$ gcloud services enable cloudbuild.googleapis.com\n\n# Ativando o Cloud Run\n$ gcloud services enable run.googleapis.com\n```\n\nVá dentro do diretório da sua aplicação e instale as dependências:\n\n```bash\n# Para os usuários do yarn\n$ yarn\n\n# Para os usuários do npm\n$ npm install\n```\n\nInicie a aplicação localmente:\n\n```bash\n# Para os usuários do yarn\n$ yarn dev\n\n# Para os usuários do npm\n$ npm run dev\n```\n\nVerifique se tudo está a funcionar.\n\n## Adicionar a sua aplicação em um contentor\n\nAgora, nós criaremos um contentor com o Cloud Build.\n\nVocê precisa adicionar a sua aplicação Nuxt um ficheiro `Dockerfile`. Crie um novo ficheiro com o nome `Dockerfile` dentro da raiz do diretório do seu projeto e adicione o seguinte conteúdo:\n\nPara os usuários do yarn:\n\n```Dockerfile\nFROM node:14\n\nWORKDIR /usr/src/app\n\nCOPY . ./\nRUN yarn\n\nEXPOSE 8080\n\nENV HOST=0.0.0.0\nENV PORT=8080\n\nRUN yarn build\n\nCMD [ \"yarn\", \"start\" ]\n```\n\nPara os usuários do npm:\n\n```Dockerfile\nFROM node:14\n\nWORKDIR /usr/src/app\n\nCOPY . ./\nRUN npm install\n\nEXPOSE 8080\n\nENV HOST=0.0.0.0\nENV PORT=8080\n\nRUN npm run build\n\nCMD [ \"npm\", \"run\", \"start\" ]\n```\n\nExecute o seguinte comando para iniciar o processo de construção:\n\n`gcloud builds submit --tag gcr.io/<YOUR_GOOGLE_CLOUD_PROJECT_ID>/my-nuxt-app-name:1.0.0 .`\n\n!Atenção: se você quiser implementar entrega contínuas (CD) ou ficheiros de configurações `.env`, você terá de usar um [ficheiro de configuração do Cloud Build](https://cloud.google.com/cloud-build/docs/build-config).\n\n## Desdobrando a sua aplicação no Cloud Run\n\nExecute o seguinte comando para desdobrar a sua aplicação:\n\n`gcloud run deploy --image=gcr.io/<YOUR_GOOGLE_CLOUD_PROJECT_ID>/my-nuxt-app-name:1.0.0 --platform managed --port 3000`\n\nPermita invocações não autenticadas se você quiser definir um acesso público.\n\nEsteja ciente de que as aplicações do Cloud Run terão um valor de concorrência padrão de 80 (cada instância do contentor manipulará até 80 requisições por vez). Você pode especificar o valor de concorrência esta maneira:\n\n`gcloud run deploy --image=gcr.io/<YOUR_GOOGLE_CLOUD_PROJECT_ID>/my-nuxt-app-name:1.0.0 --platform managed --port 3000 --concurrency <YOUR_CONCURRENCY_VALUE>`\n\nExecute o seguinte comando para verificar se o desdobramento foi criado com sucesso:\n\n`gcloud run services list --platform managed`\n\nUma lista de serviços do Cloud Run é exibido, clique na URL do desdobramento e aprecie o resultado!\n","ast":{"type":"root","children":[{"type":"element","tag":"prose-h1","props":{"class":"d-heading-title","id":"desdobrar-o-nuxt-no-google-cloud-run"},"children":[{"type":"text","value":"Desdobrar o Nuxt no Google Cloud Run"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{"class":"d-heading-description"},"children":[{"type":"text","value":"Como desdobrar o Nuxt no Google Cloud Run?"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-hr","props":{"class":"d-heading-hr"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"O "},{"type":"element","tag":"prose-a","props":{"href":"https://cloud.google.com/run","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"Google Cloud Run"}]},{"type":"text","value":" é uma plataforma de computação completamente gerida para desdobramento e escalamento de aplicações rapidamente e seguramente adicionadas em contentores."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Neste guia, nós simplesmente carregamos a pasta inteira do projeto para o Google Cloud Build com um "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Dockerfile"}]},{"type":"text","value":". Depois de carregar, o Cloud Build gerará automaticamente um contentor. Depois nós desdobraremos este contentor para o Google Cloud Run o qual iniciará ele com o script "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"start"}]},{"type":"text","value":" dentro do nosso "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"pontapé-de-saída"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#pontap%C3%A9-de-sa%C3%ADda"},"children":[{"type":"text","value":"Pontapé de Saída"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Certifique-se de que você tem uma conta no Google Cloud, um projeto e os acessos como editor no Cloud Build e no Cloud Run. Além disso, certifique-se de descarregar e instalar a interface de linha de comando do Cloud SDK a partir do Google como explicado "},{"type":"element","tag":"prose-a","props":{"href":"https://cloud.google.com/sdk/","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"aqui"}]},{"type":"text","value":" e inicie a sessão com a sua conta do Google Cloud. Se você não quiser descarregar o Cloud SDK esteja ciente de que você pode usar a interface de linha de comando "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"gcloud"}]},{"type":"text","value":" a partir do Google Cloud Console."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Agora, vamos fazer algumas verificações!"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Se a API do Cloud Build e a API do Cloud Run não estiverem ativadas, ative elas:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-bash"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# Ativando o Cloud Build"}]},{"type":"text","value":"\n$ gcloud services "},{"type":"element","tag":"span","props":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"enable"}]},{"type":"text","value":" cloudbuild.googleapis.com\n\n"},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# Ativando o Cloud Run"}]},{"type":"text","value":"\n$ gcloud services "},{"type":"element","tag":"span","props":{"className":["token","builtin","class-name"]},"children":[{"type":"text","value":"enable"}]},{"type":"text","value":" run.googleapis.com\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Vá dentro do diretório da sua aplicação e instale as dependências:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-bash"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# Para os usuários do yarn"}]},{"type":"text","value":"\n$ "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"yarn"}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# Para os usuários do npm"}]},{"type":"text","value":"\n$ "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"npm"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"install"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Inicie a aplicação localmente:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-bash"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# Para os usuários do yarn"}]},{"type":"text","value":"\n$ "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"yarn"}]},{"type":"text","value":" dev\n\n"},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"# Para os usuários do npm"}]},{"type":"text","value":"\n$ "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"npm"}]},{"type":"text","value":" run dev\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Verifique se tudo está a funcionar."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"adicionar-a-sua-aplicação-em-um-contentor"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#adicionar-a-sua-aplica%C3%A7%C3%A3o-em-um-contentor"},"children":[{"type":"text","value":"Adicionar a sua aplicação em um contentor"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Agora, nós criaremos um contentor com o Cloud Build."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Você precisa adicionar a sua aplicação Nuxt um ficheiro "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Dockerfile"}]},{"type":"text","value":". Crie um novo ficheiro com o nome "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Dockerfile"}]},{"type":"text","value":" dentro da raiz do diretório do seu projeto e adicione o seguinte conteúdo:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Para os usuários do yarn:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-text"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"FROM node:14\n\nWORKDIR /usr/src/app\n\nCOPY . ./\nRUN yarn\n\nEXPOSE 8080\n\nENV HOST=0.0.0.0\nENV PORT=8080\n\nRUN yarn build\n\nCMD [ \"yarn\", \"start\" ]\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Para os usuários do npm:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-text"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"text","value":"FROM node:14\n\nWORKDIR /usr/src/app\n\nCOPY . ./\nRUN npm install\n\nEXPOSE 8080\n\nENV HOST=0.0.0.0\nENV PORT=8080\n\nRUN npm run build\n\nCMD [ \"npm\", \"run\", \"start\" ]\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Execute o seguinte comando para iniciar o processo de construção:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"gcloud builds submit --tag gcr.io/<YOUR_GOOGLE_CLOUD_PROJECT_ID>/my-nuxt-app-name:1.0.0 ."}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"!Atenção: se você quiser implementar entrega contínuas (CD) ou ficheiros de configurações "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":".env"}]},{"type":"text","value":", você terá de usar um "},{"type":"element","tag":"prose-a","props":{"href":"https://cloud.google.com/cloud-build/docs/build-config","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"ficheiro de configuração do Cloud Build"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"desdobrando-a-sua-aplicação-no-cloud-run"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#desdobrando-a-sua-aplica%C3%A7%C3%A3o-no-cloud-run"},"children":[{"type":"text","value":"Desdobrando a sua aplicação no Cloud Run"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Execute o seguinte comando para desdobrar a sua aplicação:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"gcloud run deploy --image=gcr.io/<YOUR_GOOGLE_CLOUD_PROJECT_ID>/my-nuxt-app-name:1.0.0 --platform managed --port 3000"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Permita invocações não autenticadas se você quiser definir um acesso público."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Esteja ciente de que as aplicações do Cloud Run terão um valor de concorrência padrão de 80 (cada instância do contentor manipulará até 80 requisições por vez). Você pode especificar o valor de concorrência esta maneira:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"gcloud run deploy --image=gcr.io/<YOUR_GOOGLE_CLOUD_PROJECT_ID>/my-nuxt-app-name:1.0.0 --platform managed --port 3000 --concurrency <YOUR_CONCURRENCY_VALUE>"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Execute o seguinte comando para verificar se o desdobramento foi criado com sucesso:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"gcloud run services list --platform managed"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Uma lista de serviços do Cloud Run é exibido, clique na URL do desdobramento e aprecie o resultado!"}]}]},"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"pontapé-de-saída","depth":2,"text":"Pontapé de Saída"},{"id":"adicionar-a-sua-aplicação-em-um-contentor","depth":2,"text":"Adicionar a sua aplicação em um contentor"},{"id":"desdobrando-a-sua-aplicação-no-cloud-run","depth":2,"text":"Desdobrando a sua aplicação no Cloud Run"}]}}}