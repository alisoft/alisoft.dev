{"key":"content:fr:docs:7.components-glossary:1.fetch.md","generatedAt":"2022-03-15T12:18:25.215Z","mtime":"2022-03-15T12:18:25.207Z","slug":"fetch","title":"La méthode fetch","position":"999900070001","to":"/docs/components-glossary/fetch","draft":false,"page":true,"language":"fr","description":"La méthode fetch est utilisée pour remplir le store avant de render la page, c'est similaire à `asyncData` sauf que cela ne remplit pas le `data` du composant.","navigation":{"title":"La méthode fetch"},"category":"components-glossary","empty":false,"body":{"raw":"---\ntitle: La méthode fetch\ndescription: La méthode fetch est utilisée pour remplir le store avant de render la page, c'est similaire à `asyncData` sauf que cela ne remplit pas le `data` du composant.\nnavigation.title: La méthode fetch\ncategory: components-glossary\n---\n# La méthode fetch\n\nLa méthode fetch est utilisée pour remplir le store avant de render la page, c'est similaire à `asyncData` sauf que cela ne remplit pas le `data` du composant.\n\n---\n\n## Nuxt >= 2.12\n\nAvec l'arrivée de la `v2.12` de Nuxt, nous avons droit à un nouveau hook disponible dans **tous les composants Vue**: `fetch`.\n\n::alert{type=\"info\"}\n\n`fetch(context)` a été déprécié, à la place on peut utiliser un [middleware anonyme](/docs/components-glossary/middleware#middleware-anonyme) dans la page: `middleware(context)`\n\n::\n\n### Quand utiliser fetch?\n\nÀ chaque fois que l'on a besoin d'avoir de la data **asynchrone**. `fetch` est appelé côté serveur pour render les routes et côté client lors de la navigation.\n\nIl expose `$fetchState` au niveau du composant:\n\n- `$fetchState.pending`: `Boolean`, permet d'afficher un placeholder pendant que fetch est appelé (côté client).\n- `$fetchState.error`: `null` ou `Error`, vous permet d'afficher un message d'erreur\n- `$fetchState.timestamp`: `Integer`, l'horodatage du dernier fetch, utile en combinaison avec `keep-alive` pour de la mise en cache.\n\nSi vous souhaitez appeler le hook `fetch` depuis votre template, utilisez:\n\n```html\n<button @click=\"$fetch\">Rafraîchir</button>\n```\n\nou la méthode dans le composant:\n\n```javascript\n// méthode dans la section script\nexport default {\n  methods: {\n    refresh() {\n      this.$fetch()\n    }\n  }\n}\n```\n\nOn peut accéder au [context](/docs/internals-glossary/context) de Nuxt à l'intérieur du hook `fetch` en utilisant `this.$nuxt.context`.\n\n### Options\n\n- `fetchOnServer`: `Boolean` ou `Function` (par défaut: `true`), appelle `fetch()` lors d'un render de page côté serveur\n- `fetchDelay`: `Integer` (défaut: `200`), définit un temps d'exécution minimal en millisecondes (pour éviter les flashs)\n\n::alert{type=\"info\"}\n\nQuand `fetchOnServer` est falsy (`false` ou retourne `false`), `fetch` sera appelé uniquement côté client et `$fetchState.pending` retournera `true` lors d'un render côté serveur du composant.\n\n::\n\n```html\n<script>\n  export default {\n    data() {\n      return {\n        posts: []\n      }\n    },\n    async fetch() {\n      this.posts = await this.$http.$get(\n        'https://jsonplaceholder.typicode.com/posts'\n      )\n    },\n    fetchOnServer: false\n  }\n</script>\n```\n","ast":{"type":"root","children":[{"type":"element","tag":"prose-h1","props":{"class":"d-heading-title","id":"la-méthode-fetch"},"children":[{"type":"text","value":"La méthode fetch"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{"class":"d-heading-description"},"children":[{"type":"text","value":"La méthode fetch est utilisée pour remplir le store avant de render la page, c'est similaire à "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":" sauf que cela ne remplit pas le "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"data"}]},{"type":"text","value":" du composant."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-hr","props":{"class":"d-heading-hr"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"nuxt--212"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#nuxt--212"},"children":[{"type":"text","value":"Nuxt >= 2.12"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Avec l'arrivée de la "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"v2.12"}]},{"type":"text","value":" de Nuxt, nous avons droit à un nouveau hook disponible dans "},{"type":"element","tag":"prose-strong","props":{},"children":[{"type":"text","value":"tous les composants Vue"}]},{"type":"text","value":": "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch(context)"}]},{"type":"text","value":" a été déprécié, à la place on peut utiliser un "},{"type":"element","tag":"prose-a","props":{"href":"/docs/components-glossary/middleware#middleware-anonyme"},"children":[{"type":"text","value":"middleware anonyme"}]},{"type":"text","value":" dans la page: "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"middleware(context)"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"quand-utiliser-fetch"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#quand-utiliser-fetch"},"children":[{"type":"text","value":"Quand utiliser fetch?"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"À chaque fois que l'on a besoin d'avoir de la data "},{"type":"element","tag":"prose-strong","props":{},"children":[{"type":"text","value":"asynchrone"}]},{"type":"text","value":". "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" est appelé côté serveur pour render les routes et côté client lors de la navigation."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Il expose "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$fetchState"}]},{"type":"text","value":" au niveau du composant:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$fetchState.pending"}]},{"type":"text","value":": "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Boolean"}]},{"type":"text","value":", permet d'afficher un placeholder pendant que fetch est appelé (côté client)."},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$fetchState.error"}]},{"type":"text","value":": "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"null"}]},{"type":"text","value":" ou "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Error"}]},{"type":"text","value":", vous permet d'afficher un message d'erreur"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$fetchState.timestamp"}]},{"type":"text","value":": "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Integer"}]},{"type":"text","value":", l'horodatage du dernier fetch, utile en combinaison avec "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"keep-alive"}]},{"type":"text","value":" pour de la mise en cache."},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Si vous souhaitez appeler le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" depuis votre template, utilisez:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-html"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"button"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":"@click"}]},{"type":"element","tag":"span","props":{"className":["token","attr-value"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation","attr-equals"]},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]},{"type":"text","value":"$fetch"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"Rafraîchir"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"button"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"ou la méthode dans le composant:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-javascript"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// méthode dans la section script"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  methods"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"refresh"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"$fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"On peut accéder au "},{"type":"element","tag":"prose-a","props":{"href":"/docs/internals-glossary/context"},"children":[{"type":"text","value":"context"}]},{"type":"text","value":" de Nuxt à l'intérieur du hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" en utilisant "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"this.$nuxt.context"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"options"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#options"},"children":[{"type":"text","value":"Options"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetchOnServer"}]},{"type":"text","value":": "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Boolean"}]},{"type":"text","value":" ou "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Function"}]},{"type":"text","value":" (par défaut: "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"), appelle "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch()"}]},{"type":"text","value":" lors d'un render de page côté serveur"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetchDelay"}]},{"type":"text","value":": "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Integer"}]},{"type":"text","value":" (défaut: "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"200"}]},{"type":"text","value":"), définit un temps d'exécution minimal en millisecondes (pour éviter les flashs)"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Quand "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetchOnServer"}]},{"type":"text","value":" est falsy ("},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"false"}]},{"type":"text","value":" ou retourne "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"false"}]},{"type":"text","value":"), "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" sera appelé uniquement côté client et "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$fetchState.pending"}]},{"type":"text","value":" retournera "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"true"}]},{"type":"text","value":" lors d'un render côté serveur du composant."}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-html"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"element","tag":"span","props":{"className":["token","script"]},"children":[{"type":"element","tag":"span","props":{"className":["token","language-javascript"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        posts"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"async"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"posts"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"await"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"$http"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"$get"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'https://jsonplaceholder.typicode.com/posts'"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    fetchOnServer"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"false"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n"}]}]}]}]},"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"nuxt--212","depth":2,"text":"Nuxt >= 2.12","children":[{"id":"quand-utiliser-fetch","depth":3,"text":"Quand utiliser fetch?"},{"id":"options","depth":3,"text":"Options"}]}]}}}