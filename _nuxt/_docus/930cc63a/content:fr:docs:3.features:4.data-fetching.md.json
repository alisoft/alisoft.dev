{"key":"content:fr:docs:3.features:4.data-fetching.md","generatedAt":"2022-03-15T12:42:46.670Z","mtime":"2022-03-15T12:42:46.642Z","slug":"data-fetching","title":"Récupération de la data","position":"999900030004","to":"/docs/features/data-fetching","draft":false,"page":true,"language":"fr","description":"Dans Nuxt, nous avons 2 façons de récupérer de la data depuis une API. Nous pouvons utiliser la méthode fetch ou bien asyncData.","category":"features","csb_link":"https://codesandbox.io/embed/github/nuxt-academy/guides-examples/tree/master/03_features/04_data_fetching?fontsize=14&hidenavigation=1&theme=dark","empty":false,"body":{"raw":"---\ntitle: Récupération de la data\ndescription: Dans Nuxt, nous avons 2 façons de récupérer de la data depuis une API. Nous pouvons utiliser la méthode fetch ou bien asyncData.\ncategory: features\ncsb_link: https://codesandbox.io/embed/github/nuxt-academy/guides-examples/tree/master/03_features/04_data_fetching?fontsize=14&hidenavigation=1&theme=dark\n---\n# Récupération de la data\n\nDans Nuxt, nous avons 2 façons de récupérer de la data depuis une API. Nous pouvons utiliser la méthode fetch ou bien asyncData.\n\n---\n\nNuxt prend en charge les modèles Vue traditionnels pour le chargement de données dans votre application côté client, comme la récupération de données dans le hook `mounted()` d'un composant. Cependant, les applications universelles doivent utiliser des hooks spécifiques à Nuxt pour pouvoir restituer les données lors du rendu côté serveur. Cela permet à votre page de s'afficher avec toutes ses données requises présentes.\n\nNuxt a deux hooks pour le chargement asynchrone des données:\n\n- Le hook `fetch` (Nuxt 2.12+). Ce hook peut être placé sur n'importe quel composant et fournit des raccourcis pour le rendu des états de chargement (pendant le rendu côté client) et des erreurs.\n- Le hook `asyncData`. Ce hook ne peut être placé que sur les composants _page_. Contrairement à `fetch`, ce hook n'affiche pas d'espace réservé de chargement pendant le rendu côté client: à la place, ce hook bloque la navigation de l'itinéraire jusqu'à ce qu'il soit résolu, affichant une erreur de page en cas d'échec.\n\n::alert{type=\"info\"}\n\nDans les versions de Nuxt antérieures à la 2.12, le hook `fetch` fonctionnait un peu comme `asyncData` aujourd'hui. Cette fonctionnalité est toujours supportée aujourd'hui pour des raisons de rétrocompatibilité: si un argument `context` est accepté dans votre `fetch()`, il sera considéré comme un hook de récupération \"hérité\". Cette fonctionnalité est obsolète et doit être remplacée par `asyncData(context)` ou par un [middleware anonyme](/docs/directory-structure/middleware#anonymous-middleware) en utilisant `middleware(context)`.\n\n::\n\nCes hooks peuvent être utilisés avec _toute bibliothèque de récupération de données_ que vous choisissez. Nous vous recommandons d'utiliser [@nuxt/http](https://http.nuxtjs.org/) ou [@nuxt/axios](https://axios.nuxtjs.org/) pour faire des requêtes HTTP aux API. Vous trouverez plus d'informations sur ces bibliothèques, telles que des guides de configuration, des en-têtes d'authentification, dans leur documentation respective.\n\n## Le hook fetch\n\n::alert{type=\"info\"}\n\nCe hook est uniquement disponible à partir de Nuxt `2.12+`.\n\n::\n\nLe hook `fetch` de Nuxt est appelé après que l'instanciation du composant soit faite côté serveur: `this` est disponible à l'intérieur.\n\n```js\nexport default {\n  async fetch() {\n    console.log(this)\n  }\n}\n```\n\n::alert{type=\"info\"}\n\n`fetch(context)` a été déprécié dans nos pages, il faut utiliser un [middleware anonyme](/docs/directory-structure/middleware#anonymous-middleware) à la place: `middleware(context)`\n\n::\n\n### Quand utiliser fetch?\n\nÀ chaque fois que nous avons besoin d'avoir de la data asynchrone. `fetch` est appelé côté serveur lors du render de la route et côté client lors de la navigation.\n\nCela expose `$fetchState` au niveau du composant et avec les propriétés suivantes:\n\n- `pending` est un Booléen, il permet d'afficher un placeholder quand `fetch` est appelé _côté client_.\n- `error`, il peut être soit à `null` soit à `Error` et nous permet d'afficher un message\n- `timestamp` est l'horodatage du dernier `fetch`, cela peut s'avérer utile pour faire du [cache avec `keep-alive`](#caching)\n\nNous avons aussi accès à `this.$fetch()`, utile si nous voulons appeler le hook `fetch` dans notre composant.\n\n```html{}[components/NuxtMountains.vue]\n<template>\n  <p v-if=\"$fetchState.pending\">Récupération des montagnes... ⛰️</p>\n  <p v-else-if=\"$fetchState.error\">Une erreur est survenue :(</p>\n  <div v-else>\n    <h1>Montagnes Nuxt</h1>\n    <ul v-for=\"mountain of mountains\">\n      <li>{{ mountain.title }}</li>\n    </ul>\n    <button @click=\"$fetch\">Actualiser</button>\n  </div>\n</template>\n\n<script>\n  export default {\n    data() {\n      return {\n        mountains: []\n      }\n    },\n    async fetch() {\n      this.mountains = await fetch(\n        'https://api.nuxtjs.dev/mountains'\n      ).then(res => res.json())\n    }\n  }\n</script>\n```\n\n::alert{type=\"info\"}\n\nOn peut accéder au [contexte](/docs/concepts/context-helpers) Nuxt à l'intérieur du hook `fetch` avec `this.$nuxt.context`.\n\n::\n\n### Options\n\n`fetchOnServer`: Un booléen ou une fonction (par défaut: `true`), utile si on veut appeler `fetch()` lors du render de la page côté serveur.\n\n`fetchDelay`: Un entier (par défaut: `200`), définit une limite minimale exprimée en millisecondes de temps d'exécution (pour éviter les flashs).\n\nLorsque `fetchOnServer` est falsy (`false` ou retourne quelque chose de faux), `fetch` sera appelé uniquement côté client et `$fetchState.pending` retournera `true` lors du render du composant côté serveur.\n\n```js\nexport default {\n  data() {\n    return {\n      posts: []\n    }\n  },\n  async fetch() {\n    this.posts = await fetch('https://api.nuxtjs.dev/posts').then(res =>\n      res.json()\n    )\n  },\n  // on appelle fetch uniquement du côté client\n  fetchOnServer: false\n}\n```\n\n### Écoute des modifications des query strings\n\nLe hook `fetch` n'est pas appelé sur les modifications des query strings par défaut. Pour surveiller ces modifications, nous pouvons ajouter un watcher sur `$route.query` et appeler `$fetch`:\n\n```js\nexport default {\n  watch: {\n    '$route.query': '$fetch'\n  },\n  async fetch() {\n    // appelé aussi lors des modifications de query\n  }\n}\n```\n\n### Mise en cache\n\nNous pouvons utiliser la directive `keep-alive` dans les composants `<nuxt/>` et `<nuxt-child>` pour sauvegarder le résultat des appels de `fetch` dans les pages déjà visitées:\n\n```html{}[layouts/default.vue]\n<template>\n  <nuxt keep-alive />\n</template>\n```\n\nNous pouvons aussi spécifier les [props](https://vuejs.org/v2/api/#keep-alive) passées à `<keep-alive>` en passant la prop `keep-alive-props` au composant `<nuxt>`.\n\n```html{}[layouts/default.vue]\n<nuxt keep-alive :keep-alive-props=\"{ max: 10 }\" />\n```\n\nLe code ci-dessus va garder en mémoire 10 composants `page`.\n\n### Utiliser le hook `activated`\n\nNuxt va directement remplir `this.$fetchState.timestamp` (horodatage) avec le dernier appel de `fetch` (cela inclut le SSR). Nous pouvons utiliser cette propriété en combinaison avec le hook `activated` pour ajouter 30 secondes de cache à `fetch`:\n\n```html{}[pages/posts/_id.vue]\n<template> ... </template>\n\n<script>\n  export default {\n    data() {\n      return {\n        posts: []\n      }\n    },\n    activated() {\n      // appeller fetch de nouveau si le dernier appel date de plus de 30 secondes\n      if (this.$fetchState.timestamp <= Date.now() - 30000) {\n        this.$fetch()\n      }\n    },\n    async fetch() {\n      this.posts = await fetch('https://api.nuxtjs.dev/posts').then(res =>\n        res.json()\n      )\n    }\n  }\n</script>\n```\n\nLa navigation à la même page ne va pas rappeler `fetch` tant que le dernier call ne date pas d'au moins 30 secondes.\n\n## Async Data\n\n::alert{type=\"info\"}\n\n`asyncData` est seulement disponible pour les [pages](/docs/directory-structure/pages) et nous n'avons donc pas accès à `this` à l'intérieur du hook.\n\n::\n\nLa différence principale avec `fetch` est que vous n'avez pas à gérer les status d'erreur ou en cours. Nuxt va attendre que le hook `asyncData` soit terminé avant de procéder à la navigation sur la page suivante ou afficher la [page d'erreur](/docs/directory-structure/layouts#error-page)\n\nCe hook reçoit [le contexte](/docs/concepts/context-helpers) en tant que premier argument. Nous pouvons l'utiliser pour aller chercher de la data et Nuxt va automatiquement fusionner l'object retourné avec le `data` du composant.\n\n```html{}[pages/index.vue]\n<template>\n  <h1>{{ project }}</h1>\n</template>\n\n<script>\n  export default {\n    async asyncData(context) {\n      return {\n        project: 'nuxt'\n      }\n    }\n  }\n</script>\n```\n\nDans les exemples qui suivent nous utilisons [@nuxt/http](https://http.nuxtjs.org/), que nous recommandons pour aller récupérer de la data d'une API.\n\n### Écouter les changements de query\n\nLa méthode `asyncData` n'est pas appelée par défaut sur les modifications liées aux query strings. Si nous souhaitons changer ce comportement, pour par exemple créer un composant de pagination, nous pouvons configurer des paramètres qui seront par la suite écoutés grâce à la propriété `watchQuery` sur le composant de notre page.\n\n::alert{type=\"info\"}\n\nPour en apprendre davantage sur la [propriété watchQuery](/docs/components-glossary/watchquery) et voir la liste des [clés disponibles dans le contexte](/docs/concepts/context-helpers).\n\n::\n","ast":{"type":"root","children":[{"type":"element","tag":"prose-h1","props":{"class":"d-heading-title","id":"récupération-de-la-data"},"children":[{"type":"text","value":"Récupération de la data"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{"class":"d-heading-description"},"children":[{"type":"text","value":"Dans Nuxt, nous avons 2 façons de récupérer de la data depuis une API. Nous pouvons utiliser la méthode fetch ou bien asyncData."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-hr","props":{"class":"d-heading-hr"},"children":[]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Nuxt prend en charge les modèles Vue traditionnels pour le chargement de données dans votre application côté client, comme la récupération de données dans le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"mounted()"}]},{"type":"text","value":" d'un composant. Cependant, les applications universelles doivent utiliser des hooks spécifiques à Nuxt pour pouvoir restituer les données lors du rendu côté serveur. Cela permet à votre page de s'afficher avec toutes ses données requises présentes."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Nuxt a deux hooks pour le chargement asynchrone des données:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" (Nuxt 2.12+). Ce hook peut être placé sur n'importe quel composant et fournit des raccourcis pour le rendu des états de chargement (pendant le rendu côté client) et des erreurs."},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"text","value":"Le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":". Ce hook ne peut être placé que sur les composants "},{"type":"element","tag":"prose-em","props":{},"children":[{"type":"text","value":"page"}]},{"type":"text","value":". Contrairement à "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":", ce hook n'affiche pas d'espace réservé de chargement pendant le rendu côté client: à la place, ce hook bloque la navigation de l'itinéraire jusqu'à ce qu'il soit résolu, affichant une erreur de page en cas d'échec."},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Dans les versions de Nuxt antérieures à la 2.12, le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" fonctionnait un peu comme "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":" aujourd'hui. Cette fonctionnalité est toujours supportée aujourd'hui pour des raisons de rétrocompatibilité: si un argument "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"context"}]},{"type":"text","value":" est accepté dans votre "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch()"}]},{"type":"text","value":", il sera considéré comme un hook de récupération \"hérité\". Cette fonctionnalité est obsolète et doit être remplacée par "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"asyncData(context)"}]},{"type":"text","value":" ou par un "},{"type":"element","tag":"prose-a","props":{"href":"/docs/directory-structure/middleware#anonymous-middleware"},"children":[{"type":"text","value":"middleware anonyme"}]},{"type":"text","value":" en utilisant "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"middleware(context)"}]},{"type":"text","value":"."}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Ces hooks peuvent être utilisés avec "},{"type":"element","tag":"prose-em","props":{},"children":[{"type":"text","value":"toute bibliothèque de récupération de données"}]},{"type":"text","value":" que vous choisissez. Nous vous recommandons d'utiliser "},{"type":"element","tag":"prose-a","props":{"href":"https://http.nuxtjs.org/","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"@nuxt/http"}]},{"type":"text","value":" ou "},{"type":"element","tag":"prose-a","props":{"href":"https://axios.nuxtjs.org/","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"@nuxt/axios"}]},{"type":"text","value":" pour faire des requêtes HTTP aux API. Vous trouverez plus d'informations sur ces bibliothèques, telles que des guides de configuration, des en-têtes d'authentification, dans leur documentation respective."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"le-hook-fetch"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#le-hook-fetch"},"children":[{"type":"text","value":"Le hook fetch"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Ce hook est uniquement disponible à partir de Nuxt "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"2.12+"}]},{"type":"text","value":"."}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" de Nuxt est appelé après que l'instanciation du composant soit faite côté serveur: "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"this"}]},{"type":"text","value":" est disponible à l'intérieur."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-js"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"async"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","console","class-name"]},"children":[{"type":"text","value":"console"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"log"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch(context)"}]},{"type":"text","value":" a été déprécié dans nos pages, il faut utiliser un "},{"type":"element","tag":"prose-a","props":{"href":"/docs/directory-structure/middleware#anonymous-middleware"},"children":[{"type":"text","value":"middleware anonyme"}]},{"type":"text","value":" à la place: "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"middleware(context)"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"quand-utiliser-fetch"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#quand-utiliser-fetch"},"children":[{"type":"text","value":"Quand utiliser fetch?"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"À chaque fois que nous avons besoin d'avoir de la data asynchrone. "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" est appelé côté serveur lors du render de la route et côté client lors de la navigation."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Cela expose "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$fetchState"}]},{"type":"text","value":" au niveau du composant et avec les propriétés suivantes:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-ul","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"pending"}]},{"type":"text","value":" est un Booléen, il permet d'afficher un placeholder quand "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" est appelé "},{"type":"element","tag":"prose-em","props":{},"children":[{"type":"text","value":"côté client"}]},{"type":"text","value":"."},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"error"}]},{"type":"text","value":", il peut être soit à "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"null"}]},{"type":"text","value":" soit à "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"Error"}]},{"type":"text","value":" et nous permet d'afficher un message"},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-li","props":{},"children":[{"type":"text","value":"\n"},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"timestamp"}]},{"type":"text","value":" est l'horodatage du dernier "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":", cela peut s'avérer utile pour faire du "},{"type":"element","tag":"prose-a","props":{"href":"#caching"},"children":[{"type":"text","value":"cache avec "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"keep-alive"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Nous avons aussi accès à "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"this.$fetch()"}]},{"type":"text","value":", utile si nous voulons appeler le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" dans notre composant."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"components/NuxtMountains.vue"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-html"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"p"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":"v-if"}]},{"type":"element","tag":"span","props":{"className":["token","attr-value"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation","attr-equals"]},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]},{"type":"text","value":"$fetchState.pending"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"Récupération des montagnes... ⛰️"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"p"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"p"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":"v-else-if"}]},{"type":"element","tag":"span","props":{"className":["token","attr-value"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation","attr-equals"]},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]},{"type":"text","value":"$fetchState.error"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"Une erreur est survenue :("},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"p"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"div"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":"v-else"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"h1"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"Montagnes Nuxt"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"h1"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"ul"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":"v-for"}]},{"type":"element","tag":"span","props":{"className":["token","attr-value"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation","attr-equals"]},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]},{"type":"text","value":"mountain of mountains"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"li"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"{{ mountain.title }}"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"li"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"ul"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"button"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":"@click"}]},{"type":"element","tag":"span","props":{"className":["token","attr-value"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation","attr-equals"]},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]},{"type":"text","value":"$fetch"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"Actualiser"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"button"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"div"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"element","tag":"span","props":{"className":["token","script"]},"children":[{"type":"element","tag":"span","props":{"className":["token","language-javascript"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        mountains"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"async"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"mountains"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"await"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'https://api.nuxtjs.dev/mountains'"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","parameter"]},"children":[{"type":"text","value":"res"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","arrow","operator"]},"children":[{"type":"text","value":"=>"}]},{"type":"text","value":" res"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"On peut accéder au "},{"type":"element","tag":"prose-a","props":{"href":"/docs/concepts/context-helpers"},"children":[{"type":"text","value":"contexte"}]},{"type":"text","value":" Nuxt à l'intérieur du hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" avec "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"this.$nuxt.context"}]},{"type":"text","value":"."}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"options"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#options"},"children":[{"type":"text","value":"Options"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetchOnServer"}]},{"type":"text","value":": Un booléen ou une fonction (par défaut: "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"true"}]},{"type":"text","value":"), utile si on veut appeler "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch()"}]},{"type":"text","value":" lors du render de la page côté serveur."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetchDelay"}]},{"type":"text","value":": Un entier (par défaut: "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"200"}]},{"type":"text","value":"), définit une limite minimale exprimée en millisecondes de temps d'exécution (pour éviter les flashs)."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Lorsque "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetchOnServer"}]},{"type":"text","value":" est falsy ("},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"false"}]},{"type":"text","value":" ou retourne quelque chose de faux), "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" sera appelé uniquement côté client et "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$fetchState.pending"}]},{"type":"text","value":" retournera "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"true"}]},{"type":"text","value":" lors du render du composant côté serveur."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-js"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      posts"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"async"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"posts"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"await"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'https://api.nuxtjs.dev/posts'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","parameter"]},"children":[{"type":"text","value":"res"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","arrow","operator"]},"children":[{"type":"text","value":"=>"}]},{"type":"text","value":"\n      res"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// on appelle fetch uniquement du côté client"}]},{"type":"text","value":"\n  fetchOnServer"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","boolean"]},"children":[{"type":"text","value":"false"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"écoute-des-modifications-des-query-strings"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#%C3%A9coute-des-modifications-des-query-strings"},"children":[{"type":"text","value":"Écoute des modifications des query strings"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" n'est pas appelé sur les modifications des query strings par défaut. Pour surveiller ces modifications, nous pouvons ajouter un watcher sur "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$route.query"}]},{"type":"text","value":" et appeler "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"$fetch"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"pre","props":{"className":["line-numbers","language-js"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n  watch"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'$route.query'"}]},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'$fetch'"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"async"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// appelé aussi lors des modifications de query"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"mise-en-cache"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#mise-en-cache"},"children":[{"type":"text","value":"Mise en cache"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Nous pouvons utiliser la directive "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"keep-alive"}]},{"type":"text","value":" dans les composants "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"<nuxt/>"}]},{"type":"text","value":" et "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"<nuxt-child>"}]},{"type":"text","value":" pour sauvegarder le résultat des appels de "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" dans les pages déjà visitées:"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"layouts/default.vue"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-html"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"nuxt"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":"keep-alive"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"/>"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Nous pouvons aussi spécifier les "},{"type":"element","tag":"prose-a","props":{"href":"https://vuejs.org/v2/api/#keep-alive","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"props"}]},{"type":"text","value":" passées à "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"<keep-alive>"}]},{"type":"text","value":" en passant la prop "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"keep-alive-props"}]},{"type":"text","value":" au composant "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"<nuxt>"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"layouts/default.vue"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-html"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"nuxt"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":"keep-alive"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","attr-name"]},"children":[{"type":"text","value":":keep-alive-props"}]},{"type":"element","tag":"span","props":{"className":["token","attr-value"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation","attr-equals"]},"children":[{"type":"text","value":"="}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]},{"type":"text","value":"{ max: 10 }"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"\""}]}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"/>"}]}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Le code ci-dessus va garder en mémoire 10 composants "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"page"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"utiliser-le-hook-activated"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#utiliser-le-hook-activated"},"children":[{"type":"text","value":"Utiliser le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"activated"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Nuxt va directement remplir "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"this.$fetchState.timestamp"}]},{"type":"text","value":" (horodatage) avec le dernier appel de "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" (cela inclut le SSR). Nous pouvons utiliser cette propriété en combinaison avec le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"activated"}]},{"type":"text","value":" pour ajouter 30 secondes de cache à "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":":"}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"pages/posts/_id.vue"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-html"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":" ... "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"element","tag":"span","props":{"className":["token","script"]},"children":[{"type":"element","tag":"span","props":{"className":["token","language-javascript"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"data"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        posts"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"["}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"]"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"activated"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","comment"]},"children":[{"type":"text","value":"// appeller fetch de nouveau si le dernier appel date de plus de 30 secondes"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"if"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"$fetchState"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"timestamp"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"<="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","known-class-name","class-name"]},"children":[{"type":"text","value":"Date"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"now"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"-"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","number"]},"children":[{"type":"text","value":"30000"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"$fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":","}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"async"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"this"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","property-access"]},"children":[{"type":"text","value":"posts"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":"="}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"await"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"fetch"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'https://api.nuxtjs.dev/posts'"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"then"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","parameter"]},"children":[{"type":"text","value":"res"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","arrow","operator"]},"children":[{"type":"text","value":"=>"}]},{"type":"text","value":"\n        res"},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"."}]},{"type":"element","tag":"span","props":{"className":["token","method","function","property-access"]},"children":[{"type":"text","value":"json"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"La navigation à la même page ne va pas rappeler "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" tant que le dernier call ne date pas d'au moins 30 secondes."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h2","props":{"id":"async-data"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#async-data"},"children":[{"type":"text","value":"Async Data"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":" est seulement disponible pour les "},{"type":"element","tag":"prose-a","props":{"href":"/docs/directory-structure/pages"},"children":[{"type":"text","value":"pages"}]},{"type":"text","value":" et nous n'avons donc pas accès à "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"this"}]},{"type":"text","value":" à l'intérieur du hook."}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"La différence principale avec "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" est que vous n'avez pas à gérer les status d'erreur ou en cours. Nuxt va attendre que le hook "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":" soit terminé avant de procéder à la navigation sur la page suivante ou afficher la "},{"type":"element","tag":"prose-a","props":{"href":"/docs/directory-structure/layouts#error-page"},"children":[{"type":"text","value":"page d'erreur"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Ce hook reçoit "},{"type":"element","tag":"prose-a","props":{"href":"/docs/concepts/context-helpers"},"children":[{"type":"text","value":"le contexte"}]},{"type":"text","value":" en tant que premier argument. Nous pouvons l'utiliser pour aller chercher de la data et Nuxt va automatiquement fusionner l'object retourné avec le "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"data"}]},{"type":"text","value":" du composant."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["filename"]},"children":[{"type":"text","value":"pages/index.vue"}]},{"type":"element","tag":"pre","props":{"className":["line-numbers","language-html"]},"children":[{"type":"element","tag":"code","props":{},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"h1"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"{{ project }}"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"h1"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"template"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n\n"},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"<"}]},{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"element","tag":"span","props":{"className":["token","script"]},"children":[{"type":"element","tag":"span","props":{"className":["token","language-javascript"]},"children":[{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"export"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","keyword","module"]},"children":[{"type":"text","value":"default"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","keyword"]},"children":[{"type":"text","value":"async"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","function"]},"children":[{"type":"text","value":"asyncData"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"("}]},{"type":"element","tag":"span","props":{"className":["token","parameter"]},"children":[{"type":"text","value":"context"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":")"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","keyword","control-flow"]},"children":[{"type":"text","value":"return"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"{"}]},{"type":"text","value":"\n        project"},{"type":"element","tag":"span","props":{"className":["token","operator"]},"children":[{"type":"text","value":":"}]},{"type":"text","value":" "},{"type":"element","tag":"span","props":{"className":["token","string"]},"children":[{"type":"text","value":"'nuxt'"}]},{"type":"text","value":"\n      "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n    "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n  "},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"}"}]},{"type":"text","value":"\n"}]}]},{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","tag"]},"children":[{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":"</"}]},{"type":"text","value":"script"}]},{"type":"element","tag":"span","props":{"className":["token","punctuation"]},"children":[{"type":"text","value":">"}]}]},{"type":"text","value":"\n"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Dans les exemples qui suivent nous utilisons "},{"type":"element","tag":"prose-a","props":{"href":"https://http.nuxtjs.org/","rel":["nofollow","noopener","noreferrer"],"target":"_blank"},"children":[{"type":"text","value":"@nuxt/http"}]},{"type":"text","value":", que nous recommandons pour aller récupérer de la data d'une API."}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-h3","props":{"id":"écouter-les-changements-de-query"},"children":[{"type":"element","tag":"prose-a","props":{"href":"#%C3%A9couter-les-changements-de-query"},"children":[{"type":"text","value":"Écouter les changements de query"}]}]},{"type":"text","value":"\n"},{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"La méthode "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":" n'est pas appelée par défaut sur les modifications liées aux query strings. Si nous souhaitons changer ce comportement, pour par exemple créer un composant de pagination, nous pouvons configurer des paramètres qui seront par la suite écoutés grâce à la propriété "},{"type":"element","tag":"prose-code-inline","props":{},"children":[{"type":"text","value":"watchQuery"}]},{"type":"text","value":" sur le composant de notre page."}]},{"type":"text","value":"\n"},{"type":"element","tag":"alert","props":{"type":"info"},"children":[{"type":"element","tag":"prose-paragraph","props":{},"children":[{"type":"text","value":"Pour en apprendre davantage sur la "},{"type":"element","tag":"prose-a","props":{"href":"/docs/components-glossary/watchquery"},"children":[{"type":"text","value":"propriété watchQuery"}]},{"type":"text","value":" et voir la liste des "},{"type":"element","tag":"prose-a","props":{"href":"/docs/concepts/context-helpers"},"children":[{"type":"text","value":"clés disponibles dans le contexte"}]},{"type":"text","value":"."}]}]}]},"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"le-hook-fetch","depth":2,"text":"Le hook fetch","children":[{"id":"quand-utiliser-fetch","depth":3,"text":"Quand utiliser fetch?"},{"id":"options","depth":3,"text":"Options"},{"id":"écoute-des-modifications-des-query-strings","depth":3,"text":"Écoute des modifications des query strings"},{"id":"mise-en-cache","depth":3,"text":"Mise en cache"},{"id":"utiliser-le-hook-activated","depth":3,"text":"Utiliser le hook activated"}]},{"id":"async-data","depth":2,"text":"Async Data","children":[{"id":"écouter-les-changements-de-query","depth":3,"text":"Écouter les changements de query"}]}]}}}